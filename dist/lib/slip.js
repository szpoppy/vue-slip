"use strict";function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{!o&&a.return&&a.return()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){function t(t){if(null==t.clientX){var e=t.targetTouches&&t.targetTouches[0]?t.targetTouches:t.changedTouches;if(e&&e[0])return t.clientX=e[0].clientX,t.clientY=e[0].clientY,[e[0].clientX,e[0].clientY]}return[t.clientX,t.clientY]}function e(t,e,n,o){t.addEventListener(p[e],n,!!o)}function n(t,e,n,o){t.removeEventListener(p[e],n,!!o)}function o(t,e){return 0==t?0:t<0?e<t?t:e>0?0:e:e>t?t:e<0?0:e}function r(n){if(!m){m=this,e(h,"move",s,!0),e(h,"up",a,!0);var o=t(n),r=_slicedToArray(o,2),i=r[0],u=r[1];this.bx=this.ax-i,this.by=this.ay-u,this.emit("start",n)}}function i(e){var n=t(e),r=_slicedToArray(n,2),i=r[0],s=r[1];return[o(m.mx,i+m.bx),o(m.my,s+m.by)]}function s(t){if(m){var e;window.getSelection?window.getSelection().removeAllRanges():h.selection.empty(),(e=m).emit.apply(e,["move"].concat(_toConsumableArray(i(t)),[t]))}}function a(t){if(m){n(h,"up",a,!0),n(h,"move",s,!0);var e=i(t),o=_slicedToArray(e,2),r=o[0],u=o[1];this.ax=r,this.ay=u,m.emit("end",r,u,t),m=null}}function u(t,e){var n=e>0?"transform "+e+"ms ease-out":"none";b.forEach(function(e){t.style[e]=n})}function c(t,e,n,o){v.forEach(function(o){t.style[o]="translate3d("+e+"px, "+n+"px, 0)"}),o&&u(t,o)}function f(t){function n(){r&&(r.setTranslate(),r=null)}var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slip",r=void 0;e(h.documentElement,"down",n),t.directive(o,{bind:function(t,e,o){var i=e.value||{},s=i.mx||-60,a=i.my||0,f=!1===i.auto?0:i.auto||100,l=0,h=0;new d(t,s,a).on("start",function(t){f&&u(this.dom,0),l=t.clientY,h=0,r&&r!=this&&n(),t.stopPropagation(),i.start&&i.start(this,t)}).on("end",function(t,e,n){if(!(h>0)){if(f){var o=Math.abs(t-this.tx)/Math.abs(s)>.1?s:0;this.tx&&(o=0==o?s:0),this.tx=o;var u=Math.abs(e-this.ty)/Math.abs(a)>.1?a:0;0!=this.ty&&(u=0==u?a:0),this.ty=u,c(this.dom,o,u,f),this.setSkewing(o,u)}r=this,i.end&&i.end(this,n)}}).on("move",function(t,e,n){0==h&&(h=Math.abs(n.clientY-l)>5?1:-1),h>0||(n.preventDefault(),c(this.dom,t,e),i.move&&i.move(this,t,e,evnet))}).assign({tx:0,ty:0,setTranslate:function(t,e){var n=this.setSkewing(t||0,e||0),o=_slicedToArray(n,2),r=o[0],i=o[1];c(this.dom,r,i,f),this.tx=r,this.ty=i}})}})}var l=(Array.prototype.slice,function(){function t(){_classCallCheck(this,t),this._monitor_=Object.assign({},this._monitor_||{})}return _createClass(t,[{key:"on",value:function(t,e){var n=this._monitor_||(this._monitor_={});return n[t]||(n[t]=[]),n[t].push(e),this}},{key:"hasEvent",value:function(t){return(this._monitor_&&this._monitor_[t]||[]).length>0||!!this["on"+t]}},{key:"onec",value:function(t,e){function n(){e.apply(this,arguments),this.off(t,n)}return this.on(t,n),this}},{key:"off",value:function(t,e){var n=this._monitor_;if(n)if(e){var o=n[t];if(o){var r=o.indexOf(e);r>-1&&o.splice(r,1)}}else t?delete n[t]:delete this._monitor_;return this}},{key:"emit",value:function(t){for(var e=this._monitor_&&this._monitor_[t]||[],n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];if(e.length)for(var i=0;i<e.length;i+=1)e[i].apply(this,o);var s=this["on"+t];return s&&s.apply(this,o),this}},{key:"assign",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return"string"==typeof e[0]?this.assign(_defineProperty({},e[0],e[1])):(e.unshift(this),Object.assign.apply(Object,e)),this}}]),t}()),h=window.document,y="ontouchstart"in h,m=void 0,p={move:y?"touchmove":"mousemove",down:y?"touchstart":"mousedown",up:y?"touchend":"mouseup"},d=function(t){function n(t,o,i){_classCallCheck(this,n);var s=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return s.dom="string"==typeof t?h.getElementById(t):t,s.ax=0,s.ay=0,s.mx=o||-60,s.my=i||0,e(s.dom,"down",r.bind(s)),s}return _inherits(n,t),_createClass(n,[{key:"setSkewing",value:function(t,e){return this.ax=o(this.mx,t||0),this.ay=o(this.my,e||0),[this.ax,this.ay]}}]),n}(l),v="WebkitTransform,MozTransform,OTransform,MsTransform,transform".split(","),b="WebkitTransition,MozTransition,OTransition,MsTransform,transition".split(",");return window.Vue&&f(window.Vue),{EventEmitter:l,Slip:d,install:f}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zbGlwLmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsImZhY3RvcnkiLCJleHBvcnRzIiwiX3R5cGVvZiIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInVuZGVmaW5lZCIsImlzVG91Y2giLCJldiIsIm1vdmVEYXRhIiwidG91Y2hlcyIsInRhcmdldFRvdWNoZXMiLCJjaGFuZ2VkVG91Y2hlcyIsImNsaWVudFgiLCJjbGllbnRZIiwiZG93biIsInR5cGUiLCJmbiIsImNhcCIsInVwIiwiZXZlbnRzIiwicmVtb3ZlRXZlbnQiLCJhcHBlbmRFdmVudCIsImRvbSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtIiwiYyIsInNsaXBEb3duIiwidGhpcyIsImRvYyIsInNsaXBNb3ZlIiwic2xpcFVwIiwiX2dldEV2ZW50WFkiLCJfZ2V0RXZlbnRYWTIiLCJfc2xpY2VkVG9BcnJheSIsIngiLCJieSIsImF5IiwieSIsImVtaXQiLCJnZXRTbGlwRGF0YSIsIl9nZXRFdmVudFhZMyIsImdldEV2ZW50WFkiLCJfZ2V0RXZlbnRYWTQiLCJnZXRNYXgiLCJieCIsIm15IiwiZXZ0IiwiX21vdmVEYXRhIiwid2luZG93IiwiZ2V0U2VsZWN0aW9uIiwicmVtb3ZlQWxsUmFuZ2VzIiwic2VsZWN0aW9uIiwiZW1wdHkiLCJhcHBseSIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheSIsImF4IiwidCIsInRTdHIiLCJ0cmFuc2l0aW9uS2V5cyIsImZvckVhY2giLCJrZXkiLCJzdHlsZSIsInNldFRyYW5zbGF0ZSIsImFuaW0iLCJ0cmFuc2Zvcm1LZXlzIiwic2V0VHJhbnNpdGlvbiIsImluc3RhbGwiLCJ2dWUiLCJjdXJyU2xpcCIsIm5hbWVkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiY2xvc2VDdXJyIiwiYmluZCIsImVsIiwiYmluZGluZyIsInZub2RlIiwib3B0IiwidmFsdWUiLCJteCIsImF1dG8iLCJ5U3RhcnQiLCJpc1Njcm9sbCIsIlNsaXAiLCJldmVudCIsInN0b3BQcm9wYWdhdGlvbiIsInN0YXJ0Iiwib24iLCJ0eCIsIk1hdGgiLCJhYnMiLCJ0eSIsImVuZCIsInByZXZlbnREZWZhdWx0IiwibW92ZSIsImV2bmV0IiwiYXNzaWduIiwiX3NldFNrZXdpbmciLCJzZXRTa2V3aW5nIiwiX3NldFNrZXdpbmcyIiwiRXZlbnRFbWl0dGVyIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJzbGljZSIsIl9jbGFzc0NhbGxDaGVjayIsIl9tb25pdG9yXyIsIk9iamVjdCIsIl9jcmVhdGVDbGFzcyIsIm1vbml0b3IiLCJwdXNoIiwiZnVuIiwiZnVueCIsIm9mZiIsImVzIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiYWciLCJfbGVuIiwiX2tleSIsImkiLCJvbkZ1biIsIl9sZW4yIiwiYXJncyIsIl9rZXkyIiwidW5zaGlmdCIsImRvY3VtZW50IiwiX0V2ZW50RW1pdHRlciIsImlkIiwiX3RoaXMiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsIl9fcHJvdG9fXyIsImdldFByb3RvdHlwZU9mIiwiY2FsbCIsImdldEVsZW1lbnRCeUlkIiwiX2luaGVyaXRzIiwic3BsaXQiXSwibWFwcGluZ3MiOiJpeERBQUMsU0FBVUEsRUFBUUMsR0FDQyxZQUFuQixtQkFBT0MsU0FBUCxZQUFBQyxRQUFPRCxXQUEwQyxtQkFBWEUsUUFBeUJBLE9BQU9GLFFBQVVELElBQzlELGtCQUFYSSxTQUF5QkEsT0FBT0MsSUFBTUQsT0FBT0osR0FBV0EsS0FGL0RNLEVBR1EsV0E4R1QsUUFBSUMsR0FBVUMsR0FFZCxHQUFJQyxNQUFBQSxFQUFBQSxRQUFKLENBS1EsR0FBSUMsR0FBVUYsRUFBR0csZUFBaUJILEVBQUdHLGNBQWMsR0FBS0gsRUFBR0csY0FBZ0JILEVBQUdJLGNBSHRGLElBQUFGLEdBQUFBLEVBQXVCLEdBSWYsTUFGQUYsR0FBR0ssUUFBSEgsRUFBb0IsR0FBQUcsUUFDcEJMLEVBQUFNLFFBQUlKLEVBQWFDLEdBQUFBLFNBQ2JELEVBQVdBLEdBQUFBLFFBQVlBLEVBQUEsR0FBQUks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QSxZQUlHUSxLQUFNUixFQUFTLGFBQWMsWUFGakNZLEdBQUlDLEVBQVMsV0FBQSxXQXVETEMsRUF0TGEsU0FBQTRHLEdBb0xMLFFBQUE1QyxHQUFBNkMsRUFBQWpELEVBQUFuQyxHQUFBNEQsZ0JBQUE5RSxLQUFBeUQsRUFBQSxJQUFBOEMsR0FBQUMsMkJBQUF4RyxNQUFBeUQsRUFBQWdELFdBQUF6QixPQUFBMEIsZUFBQWpELElBQUFrRCxLQUFBM0csTUFBQSxPQUFBdUcsR0FBQTVHLElBQUEsZ0JBQUEyRyxHQUFBckcsRUFBQTJHLGVBQUFOLEdBQUFBLEVBaUJSQyxFQUFLMUUsR0FBSyxFQWJWMEUsRUFBQTlGLEdBQUtvQixFQUVMaEQsRUFBQUEsR0FBQUEsSUFBQSxHQUNBQSxFQUFBQSxHQUFBQSxHQUFXLEVBRWxCYSxFQUFBNkcsRUFBQTVHLElBQUEsT0FBQUksRUFBQWdELEtBQUF3RCxJQVRlQSxFQXBMSyxNQUFBTSxXQUFBcEQsRUFBQTRDLEdBQUFwQixhQUFBeEIsSUFBQXZCLElBQUEsYUFBQWtCLE1BQUEsU0ErTU43QyxFQUFHRyxHQUdWLE1BakJKVixNQUFBNkIsR0FBQWIsRUFBQWhCLEtBQXFCa0IsR0FBSVgsR0FBQSxHQUFBUCxLQUFBUyxHQUFBTyxFQUFBaEIsS0FBQWtCLEdBQUFSLEdBQUEsSUFpQmJWLEtBQUs2QixHQUFJN0IsS0FBS1MsUUFsTlRnRCxHQXNMYmhFLEdBa0NKNkMsRUFBZ0IsZ0VBQWdFd0UsTUFBTSxLQWhCbEY5RSxFQUFBLG9FQUFBOEUsTUFBQSxJQXlHUTdDLE9BSkE3QixRQUFBQSxLQUNBZSxFQUFBQSxPQUFBQSxNQUdBYyxhQUFBQSxFQUFBQSxLQUFBQSxFQUZNekIsUUFBQUEiLCJmaWxlIjoibGliL3NsaXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6IGZhY3RvcnkoKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG5cbmNvbnN0IHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuLy8g6Ieq5a6a5LmJ5LqL5Lu2IOexu+S8vCBub2RlanPkuK3nmoQgRXZlbnRFbWl0dGVyXG5jbGFzcyBFdmVudEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIC8vIOWFi+mahuS4gOS7vSDkuovku7ZcbiAgICAgICAgdGhpcy5fbW9uaXRvcl8gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9tb25pdG9yXyB8fCB7fSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIOe7keWumuS6i+S7tlxuICAgICAqIEBwYXJhbSB0eXBlIOS6i+S7tuWQjeensFxuICAgICAqIEBwYXJhbSBmdW4g5LqL5Lu25pa55rOVXG4gICAgICogQHJldHVybnMge0V2ZW50RW1pdHRlcn1cbiAgICAgKi9cbiAgICBvbih0eXBlLCBmdW4pIHtcbiAgICAgICAgbGV0IG1vbml0b3IgPSB0aGlzLl9tb25pdG9yXyB8fCAodGhpcy5fbW9uaXRvcl8gPSB7fSk7XG4gICAgICAgIG1vbml0b3JbdHlwZV0gfHwgKG1vbml0b3JbdHlwZV0gPSBbXSk7XG4gICAgICAgIG1vbml0b3JbdHlwZV0ucHVzaChmdW4pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDliKTmlq3mmK/lkKbov5jmnInnibnlrprkuovku7ZcbiAgICAgKiBAcGFyYW0gdHlwZVxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGhhc0V2ZW50KHR5cGUpIHtcbiAgICAgICAgbGV0IG1vbml0b3IgPSB0aGlzLl9tb25pdG9yXyAmJiB0aGlzLl9tb25pdG9yX1t0eXBlXSB8fCBbXTtcbiAgICAgICAgcmV0dXJuIG1vbml0b3IubGVuZ3RoID4gMCB8fCAhIXRoaXNbJ29uJyArIHR5cGVdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOWPquacieaJp+ihjOS4gOasoeeahOS6i+S7tlxuICAgICAqIEBwYXJhbSB0eXBlIOS6i+S7tuWQjeensFxuICAgICAqIEBwYXJhbSBmdW4g5LqL5Lu25pa55rOVXG4gICAgICogQHJldHVybnMge0V2ZW50RW1pdHRlcn1cbiAgICAgKi9cbiAgICBvbmVjKHR5cGUsIGZ1bikge1xuICAgICAgICBmdW5jdGlvbiBmdW54KCkge1xuICAgICAgICAgICAgZnVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB0aGlzLm9mZih0eXBlLCBmdW54KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uKHR5cGUsIGZ1bngpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDnp7vpmaTkuovku7ZcbiAgICAgKiBAcGFyYW0gdHlwZSDkuovku7blkI3np7BcbiAgICAgKiBAcGFyYW0gZnVuIOS6i+S7tuaWueazlVxuICAgICAqIEByZXR1cm5zIHtFdmVudEVtaXR0ZXJ9XG4gICAgICovXG4gICAgb2ZmKHR5cGUsIGZ1bikge1xuICAgICAgICBsZXQgbW9uaXRvciA9IHRoaXMuX21vbml0b3JfO1xuICAgICAgICBpZiAobW9uaXRvcikge1xuICAgICAgICAgICAgaWYgKGZ1bikge1xuICAgICAgICAgICAgICAgIGxldCBlcyA9IG1vbml0b3JbdHlwZV07XG4gICAgICAgICAgICAgICAgaWYgKGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IGVzLmluZGV4T2YoZnVuKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgbW9uaXRvclt0eXBlXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX21vbml0b3JfO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOinpuWPkeS6i+S7tlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIOS6i+S7tuWQjeensFxuICAgICAqIEBwYXJhbSB7Kn0gYWcg5Lyg6YCS55qE5Y+C5pWwXG4gICAgICovXG4gICAgZW1pdCh0eXBlLCAuLi5hZykge1xuICAgICAgICBsZXQgZXMgPSB0aGlzLl9tb25pdG9yXyAmJiB0aGlzLl9tb25pdG9yX1t0eXBlXSB8fCBbXTtcbiAgICAgICAgaWYgKGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgIGVzW2ldLmFwcGx5KHRoaXMsIGFnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgb25GdW4gPSB0aGlzWydvbicgKyB0eXBlXTtcbiAgICAgICAgb25GdW4gJiYgb25GdW4uYXBwbHkodGhpcywgYWcpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDmianlsZXmnKzouqtcbiAgICAgKi9cbiAgICBhc3NpZ24oLi4uYXJncykge1xuICAgICAgICBpZih0eXBlb2YgYXJnc1swXSA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgdGhpcy5hc3NpZ24oe1thcmdzWzBdXTphcmdzWzFdfSlcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbi5hcHBseShPYmplY3QsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT095Z+656GAU2xpcOexuz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5sZXQgZG9jID0gd2luZG93LmRvY3VtZW50XG5cbmxldCBpc1RvdWNoID0gJ29udG91Y2hzdGFydCcgaW4gZG9jXG5cbmxldCBtb3ZlRGF0YVxuXG5mdW5jdGlvbiBnZXRFdmVudFhZKGV2KXtcbiAgICAvL+enu+WKqOaYr+WkmueCueinpuaOp++8jOm7mOiupOS9v+eUqOesrOS4gOS4quS9nOS4umNsaWVudFjlkoxjbGllbnRZXG4gICAgaWYgKGV2LmNsaWVudFggPT0gbnVsbCkge1xuICAgICAgICBsZXQgdG91Y2hlcyA9IGV2LnRhcmdldFRvdWNoZXMgJiYgZXYudGFyZ2V0VG91Y2hlc1swXSA/IGV2LnRhcmdldFRvdWNoZXMgOiBldi5jaGFuZ2VkVG91Y2hlc1xuICAgICAgICBpZiAodG91Y2hlcyAmJiB0b3VjaGVzWzBdKSB7XG4gICAgICAgICAgICBldi5jbGllbnRYID0gdG91Y2hlc1swXS5jbGllbnRYXG4gICAgICAgICAgICBldi5jbGllbnRZID0gdG91Y2hlc1swXS5jbGllbnRZXG4gICAgICAgICAgICByZXR1cm4gW3RvdWNoZXNbMF0uY2xpZW50WCwgdG91Y2hlc1swXS5jbGllbnRZXVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBbZXYuY2xpZW50WCwgZXYuY2xpZW50WV1cbn1cblxubGV0IGV2ZW50cyA9IHtcbiAgICBtb3ZlOiBpc1RvdWNoPyAndG91Y2htb3ZlJzogJ21vdXNlbW92ZScsXG4gICAgZG93bjogaXNUb3VjaD8gJ3RvdWNoc3RhcnQnOiAnbW91c2Vkb3duJyxcbiAgICB1cDogaXNUb3VjaD8gJ3RvdWNoZW5kJzogJ21vdXNldXAnXG59XG5mdW5jdGlvbiBhcHBlbmRFdmVudChkb20sIHR5cGUsIGZuLCBjYXApe1xuICAgIGRvbS5hZGRFdmVudExpc3RlbmVyKGV2ZW50c1t0eXBlXSwgZm4sICEhY2FwKVxufVxuZnVuY3Rpb24gcmVtb3ZlRXZlbnQoZG9tLCB0eXBlLCBmbiwgY2FwKXtcbiAgICBkb20ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudHNbdHlwZV0sIGZuLCAhIWNhcClcbn1cblxuZnVuY3Rpb24gZ2V0TWF4KG0sIGMpe1xuICAgIGlmKG0gPT0gMCl7XG4gICAgICAgIHJldHVybiAwXG4gICAgfVxuICAgIGlmKG0gPCAwKXtcbiAgICAgICAgcmV0dXJuIGMgPCBtID8gbSA6IChjID4gMCA/IDAgOiBjKVxuICAgIH1cbiAgICByZXR1cm4gYyA+IG0gPyBtIDogKGMgPCAwID8gMCA6IGMpXG59XG5cbi8v6byg5qCH56e75Yqo5byA5aeLXG5mdW5jdGlvbiBzbGlwRG93bihldil7XG4gICAgaWYobW92ZURhdGEpe1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgbW92ZURhdGEgPSB0aGlzXG4gICAgYXBwZW5kRXZlbnQoZG9jLCAnbW92ZScsIHNsaXBNb3ZlLCB0cnVlKVxuICAgIGFwcGVuZEV2ZW50KGRvYywgJ3VwJywgc2xpcFVwLCB0cnVlKVxuICAgIGxldCBbeCwgeV0gPSBnZXRFdmVudFhZKGV2KVxuICAgIHRoaXMuYnggPSB0aGlzLmF4IC0geFxuICAgIHRoaXMuYnkgPSB0aGlzLmF5IC0geVxuICAgIHRoaXMuZW1pdCgnc3RhcnQnLCBldilcbn1cblxuZnVuY3Rpb24gZ2V0U2xpcERhdGEoZXYpe1xuICAgIGxldCBbeCwgeV0gPSBnZXRFdmVudFhZKGV2KVxuICAgIHJldHVybiBbZ2V0TWF4KG1vdmVEYXRhLm14LCB4ICsgbW92ZURhdGEuYngpLCBnZXRNYXgobW92ZURhdGEubXksIHkgKyBtb3ZlRGF0YS5ieSldXG4gICAgLy9tb3ZlRGF0YS5lbWl0KHR5cGUsIG14LCBteSwgZXYpXG4gICAgLy9yZXR1cm4gW214LCBteV1cbn1cblxuLy/pvKDmoIfnp7vliqjkuK1cbmZ1bmN0aW9uIHNsaXBNb3ZlKGV2dCl7XG4gICAgaWYobW92ZURhdGEpe1xuICAgICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uID8gd2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpIDogZG9jLnNlbGVjdGlvbi5lbXB0eSgpXG4gICAgICAgIG1vdmVEYXRhLmVtaXQoJ21vdmUnLCAuLi5nZXRTbGlwRGF0YShldnQpLCBldnQpXG4gICAgfVxufVxuXG4vL+m8oOagh+aKrOi1t1xuZnVuY3Rpb24gc2xpcFVwKGV2dCl7XG4gICAgaWYobW92ZURhdGEpe1xuICAgICAgICByZW1vdmVFdmVudChkb2MsICd1cCcsIHNsaXBVcCwgdHJ1ZSlcbiAgICAgICAgcmVtb3ZlRXZlbnQoZG9jLCAnbW92ZScsIHNsaXBNb3ZlLCB0cnVlKVxuICAgICAgICBsZXQgW3gsIHldID0gZ2V0U2xpcERhdGEoZXZ0KVxuICAgICAgICB0aGlzLmF4ID0geFxuICAgICAgICB0aGlzLmF5ID0geVxuICAgICAgICBtb3ZlRGF0YS5lbWl0KCdlbmQnLCB4LCB5LCBldnQpXG4gICAgICAgIG1vdmVEYXRhID0gbnVsbFxuICAgIH1cbn1cblxuY2xhc3MgU2xpcCBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG4gICAgLy8g5Yid5aeL5YyWXG4gICAgY29uc3RydWN0b3IgKGlkLCBteCwgbXkpIHtcbiAgICAgICAgc3VwZXIoKVxuXG4gICAgICAgIHRoaXMuZG9tID0gdHlwZW9mIGlkID09ICdzdHJpbmcnID8gZG9jLmdldEVsZW1lbnRCeUlkKGlkKSA6IGlkXG4gICAgICAgIHRoaXMuYXggPSAwXG4gICAgICAgIHRoaXMuYXkgPSAwXG5cbiAgICAgICAgdGhpcy5teCA9IG14IHx8IC02MFxuICAgICAgICB0aGlzLm15ID0gbXkgfHwgMFxuXG4gICAgICAgIGFwcGVuZEV2ZW50KHRoaXMuZG9tLCAnZG93bicsIHNsaXBEb3duLmJpbmQodGhpcykpXG4gICAgfVxuXG4gICAgLy8g5riF55CGXG4gICAgc2V0U2tld2luZyh4LCB5KSB7XG4gICAgICAgIHRoaXMuYXggPSBnZXRNYXgodGhpcy5teCwgeCB8fCAwKVxuICAgICAgICB0aGlzLmF5ID0gZ2V0TWF4KHRoaXMubXksIHkgfHwgMClcbiAgICAgICAgcmV0dXJuIFt0aGlzLmF4LCB0aGlzLmF5XVxuICAgIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT095rOo5YaMVnVl5oyH5LukPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmxldCB0cmFuc2Zvcm1LZXlzID0gJ1dlYmtpdFRyYW5zZm9ybSxNb3pUcmFuc2Zvcm0sT1RyYW5zZm9ybSxNc1RyYW5zZm9ybSx0cmFuc2Zvcm0nLnNwbGl0KCcsJylcbmxldCB0cmFuc2l0aW9uS2V5cyA9ICdXZWJraXRUcmFuc2l0aW9uLE1velRyYW5zaXRpb24sT1RyYW5zaXRpb24sTXNUcmFuc2Zvcm0sdHJhbnNpdGlvbicuc3BsaXQoJywnKVxuXG5cbmZ1bmN0aW9uIHNldFRyYW5zaXRpb24oZG9tLCB0KXtcbiAgICBsZXQgdFN0ciA9IHQgPiAwID8gJ3RyYW5zZm9ybSAnICsgdCArICdtcyBlYXNlLW91dCc6ICdub25lJ1xuICAgIHRyYW5zaXRpb25LZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgLy8gdHJhbnNmb3JtIC4zNXMgZWFzZS1vdXRcbiAgICAgICAgZG9tLnN0eWxlW2tleV0gPSB0U3RyXG4gICAgfSlcbn1cblxuZnVuY3Rpb24gc2V0VHJhbnNsYXRlKGRvbSwgeCwgeSwgYW5pbSl7XG4gICAgdHJhbnNmb3JtS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGRvbS5zdHlsZVtrZXldID0gJ3RyYW5zbGF0ZTNkKCcgKyB4ICsgJ3B4LCAnICsgeSArICdweCwgMCknXG4gICAgfSlcbiAgICBpZihhbmltKXtcbiAgICAgICAgc2V0VHJhbnNpdGlvbihkb20sIGFuaW0pXG4gICAgfVxuICAgIC8vZG9tLnN0eWxlLlxufVxuXG5mdW5jdGlvbiBpbnN0YWxsKHZ1ZSwgbmFtZWQgPSAnc2xpcCcpe1xuXG4gICAgbGV0IGN1cnJTbGlwXG4gICAgZnVuY3Rpb24gY2xvc2VDdXJyKCkge1xuICAgICAgICBpZihjdXJyU2xpcCl7XG4gICAgICAgICAgICBjdXJyU2xpcC5zZXRUcmFuc2xhdGUoKVxuICAgICAgICAgICAgY3VyclNsaXAgPSBudWxsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhcHBlbmRFdmVudChkb2MuZG9jdW1lbnRFbGVtZW50LCAnZG93bicsIGNsb3NlQ3VycilcblxuICAgIC8vIOaMh+S7pFxuICAgIHZ1ZS5kaXJlY3RpdmUobmFtZWQsIHtcbiAgICAgICAgYmluZDogZnVuY3Rpb24oZWwsIGJpbmRpbmcsIHZub2RlKXtcbiAgICAgICAgICAgIGxldCBvcHQgPSBiaW5kaW5nLnZhbHVlIHx8IHt9XG4gICAgICAgICAgICBsZXQgbXggPSBvcHQubXggfHwgLTYwXG4gICAgICAgICAgICBsZXQgbXkgPSBvcHQubXkgfHwgMFxuICAgICAgICAgICAgbGV0IGF1dG8gPSBvcHQuYXV0byA9PT0gZmFsc2UgPyAwIDogKG9wdC5hdXRvIHx8IDEwMClcbiAgICAgICAgICAgIGxldCB5U3RhcnQgPSAwLCBpc1Njcm9sbCA9IDBcbiAgICAgICAgICAgIG5ldyBTbGlwKGVsLCBteCwgbXkpXG4gICAgICAgICAgICAub24oJ3N0YXJ0JywgZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgICAgIGlmKGF1dG8pe1xuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2l0aW9uKHRoaXMuZG9tLCAwKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB5U3RhcnQgPSBldmVudC5jbGllbnRZXG4gICAgICAgICAgICAgICAgaXNTY3JvbGwgPSAwXG4gICAgICAgICAgICAgICAgaWYoY3VyclNsaXAgJiYgY3VyclNsaXAgIT0gdGhpcyl7XG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQ3VycigpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG5cbiAgICAgICAgICAgICAgICBvcHQuc3RhcnQgJiYgb3B0LnN0YXJ0KHRoaXMsIGV2ZW50KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignZW5kJywgZnVuY3Rpb24oeCwgeSwgZXZlbnQpe1xuICAgICAgICAgICAgICAgIGlmKGlzU2Nyb2xsID4gMCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihhdXRvKXtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHR4ID0gTWF0aC5hYnMoeCAtIHRoaXMudHgpIC8gTWF0aC5hYnMobXgpID4gLjEgPyBteCA6IDBcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy50eCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eCA9IHR4ID09IDAgPyBteCA6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnR4ID0gdHhcbiAgICAgICAgICAgICAgICAgICAgbGV0IHR5ID0gTWF0aC5hYnMoeSAtIHRoaXMudHkpIC8gTWF0aC5hYnMobXkpID4gLjEgPyBteSA6IDBcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy50eSAhPSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5ID0gdHkgPT0gMCA/IG15IDogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHkgPSB0eVxuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2xhdGUodGhpcy5kb20sIHR4LCB0eSwgYXV0bylcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTa2V3aW5nKHR4LCB0eSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VyclNsaXAgPSB0aGlzXG4gICAgICAgICAgICAgICAgb3B0LmVuZCAmJiBvcHQuZW5kKHRoaXMsIGV2ZW50KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW92ZScsIGZ1bmN0aW9uKHgsIHksIGV2ZW50KXtcbiAgICAgICAgICAgICAgICBpZihpc1Njcm9sbCA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgaXNTY3JvbGwgPSBNYXRoLmFicyhldmVudC5jbGllbnRZIC0geVN0YXJ0KSA+IDUgPyAxIDogLTFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoaXNTY3JvbGwgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgc2V0VHJhbnNsYXRlKHRoaXMuZG9tLCB4LCB5KVxuICAgICAgICAgICAgICAgIG9wdC5tb3ZlICYmIG9wdC5tb3ZlKHRoaXMsIHgsIHksIGV2bmV0KVxuICAgICAgICAgICAgfSkuYXNzaWduKHtcbiAgICAgICAgICAgICAgICB0eDogMCxcbiAgICAgICAgICAgICAgICB0eTogMCxcbiAgICAgICAgICAgICAgICBzZXRUcmFuc2xhdGUgKHgsIHkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IFt0eCwgdHldID0gdGhpcy5zZXRTa2V3aW5nKHggfHwgMCwgeSB8fCAwKVxuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2xhdGUodGhpcy5kb20sIHR4LCB0eSwgYXV0bylcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50eCA9IHR4XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHkgPSB0eVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5pZih3aW5kb3cuVnVlKXtcbiAgICBpbnN0YWxsKHdpbmRvdy5WdWUpXG59XG5cbnJldHVybiB7RXZlbnRFbWl0dGVyLCBTbGlwLCBpbnN0YWxsfVxuXG59KSkpIl19
